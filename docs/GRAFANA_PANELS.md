# Scrutiny Grafana Dashboard å®Œæ•´æŒ‡å—

æœ¬æ–‡æ¡£åŒ…å« Scrutiny Grafana Dashboard çš„å®Œæ•´ä½¿ç”¨æŒ‡å—ï¼ŒåŒ…æ‹¬å¯¼å…¥æ–¹æ³•ã€é…ç½®è¯´æ˜ã€é¢æ¿è¯¦æƒ…å’Œä½¿ç”¨å»ºè®®ã€‚

## ğŸ“Š Dashboard æ¦‚è§ˆ

**Dashboard åç§°**: Scrutiny SMART ç›‘æ§  
**åˆ·æ–°é—´éš”**: 30 ç§’  
**é»˜è®¤æ—¶é—´èŒƒå›´**: æœ€è¿‘ 6 å°æ—¶  
**é¢æ¿æ€»æ•°**: 13 ä¸ª

### Dashboard é¢„è§ˆæˆªå›¾

![Grafana Dashboard æ¦‚è§ˆ](images/image.png)

*Dashboard æ•´ä½“æ¦‚è§ˆ - æ˜¾ç¤ºè®¾å¤‡ç»Ÿè®¡ã€æ¸©åº¦ç›‘æ§ã€ä½¿ç”¨ç»Ÿè®¡ç­‰å…³é”®ä¿¡æ¯*

![Grafana Dashboard è¯¦æƒ…](images/image1.png)

*Dashboard è¯¦ç»†ä¿¡æ¯ - æ˜¾ç¤ºè®¾å¤‡åˆ—è¡¨ã€é”™è¯¯ç›‘æ§ã€SMART çŠ¶æ€ç­‰è¯¦ç»†ä¿¡æ¯*

### ğŸ·ï¸ å›¾ä¾‹æ ¼å¼è¯´æ˜

æ‰€æœ‰é¢æ¿ä½¿ç”¨ç»Ÿä¸€çš„å›¾ä¾‹æ ¼å¼ï¼š**`{{host_id}}/{{device_name}}`**

**è®¾è®¡ç†å¿µ**:
- âœ… **å§‹ç»ˆæ˜¾ç¤ºä¸»æœºID**: å³ä½¿é€‰æ‹©äº†å•ä¸ªä¸»æœºï¼Œä¹Ÿä¿ç•™ä¸»æœºæ ‡è¯†ï¼Œä¾¿äºæˆªå›¾å’Œåˆ†äº«æ—¶æ¸…æ¥šè¯†åˆ«
- âœ… **ç®€æ´æ˜äº†**: ä½¿ç”¨ `/` åˆ†éš”ç¬¦ï¼Œæ ¼å¼ç´§å‡‘ï¼Œæ˜“äºé˜…è¯»
- âœ… **å¤šä¸»æœºåŒºåˆ†**: å½“é€‰æ‹©"All"æˆ–å¤šä¸ªä¸»æœºæ—¶ï¼Œç«‹å³èƒ½åŒºåˆ†è®¾å¤‡æ¥æº

**ç¤ºä¾‹æ˜¾ç¤º**:
```
pve/sda          # PVE ä¸»æœºä¸Šçš„ sda è®¾å¤‡
pve/nvme0n1      # PVE ä¸»æœºä¸Šçš„ nvme0n1 è®¾å¤‡
nas/sdb          # NAS ä¸»æœºä¸Šçš„ sdb è®¾å¤‡
backup/sdc       # Backup ä¸»æœºä¸Šçš„ sdc è®¾å¤‡
```

### ğŸ”„ æŸ¥è¯¢èšåˆè¯´æ˜

**é‡è¦**: æ‰€æœ‰æŸ¥è¯¢éƒ½ä½¿ç”¨èšåˆå‡½æ•°å»é™¤ Kubernetes Pod é‡å¯å¯¼è‡´çš„é‡å¤æ•°æ®ã€‚

- **æ•°å€¼å­—æ®µ**: ä½¿ç”¨ `max without(instance, job, pod, container, endpoint, namespace, service)`
- **çŠ¶æ€å­—æ®µ**: ä½¿ç”¨ `min without(instance, job, pod, container, endpoint, namespace, service)`ï¼ˆåªæœ‰æ‰€æœ‰å®ä¾‹éƒ½æ•…éšœæ‰æ˜¾ç¤ºæ•…éšœï¼‰
- **Info å­—æ®µ**: ä½¿ç”¨ `group without(instance, job, pod, container, endpoint, namespace, service)`ï¼ˆä»…å»é‡ï¼‰

è¿™ç¡®ä¿å³ä½¿ exporter Pod é‡å¯å¯¼è‡´ IP å˜åŒ–ï¼Œæ¯ä¸ªè®¾å¤‡ä»ç„¶åªæ˜¾ç¤ºä¸€æ¡è®°å½•ã€‚

---

## ğŸš€ å¯¼å…¥ Dashboard

### æ–¹æ³•ä¸€ï¼šé€šè¿‡ Grafana UI å¯¼å…¥ JSONï¼ˆæ¨èï¼‰

1. ç™»å½• Grafana
2. ç‚¹å‡»å·¦ä¾§èœå• **"+"** -> **"Import"**
3. ç‚¹å‡» **"Upload JSON file"**
4. é€‰æ‹© `grafana_dashboard.json` æ–‡ä»¶
5. é€‰æ‹© Prometheus æ•°æ®æº
6. ç‚¹å‡» **"Import"** å®Œæˆ

### æ–¹æ³•äºŒï¼šä½¿ç”¨ Grafana Provisioningï¼ˆæ¨èç”¨äºç”Ÿäº§ç¯å¢ƒï¼‰

å°† Dashboard JSON æ”¾åˆ° Grafana provisioning ç›®å½•ï¼Œåˆ›å»ºé…ç½®æ–‡ä»¶ `/etc/grafana/provisioning/dashboards/scrutiny.yaml`ï¼š

```yaml
apiVersion: 1

providers:
  - name: 'Scrutiny'
    orgId: 1
    folder: 'SMART Monitoring'
    type: file
    disableDeletion: false
    updateIntervalSeconds: 10
    allowUiUpdates: true
    options:
      path: /etc/grafana/provisioning/dashboards
      foldersFromFilesStructure: true
```

å°† `grafana_dashboard.json` å¤åˆ¶åˆ° `/etc/grafana/provisioning/dashboards/` ç›®å½•ï¼Œé‡å¯ Grafana åä¼šè‡ªåŠ¨åŠ è½½ã€‚

## âš™ï¸ é…ç½® Prometheus æ•°æ®æº

1. Grafana -> **"Configuration"** -> **"Data Sources"**
2. ç‚¹å‡» **"Add data source"** -> é€‰æ‹© **"Prometheus"**
3. é…ç½® URLï¼ˆä¾‹å¦‚: `http://prometheus:9090`ï¼‰
4. ç‚¹å‡» **"Save & Test"** éªŒè¯è¿æ¥

**æ³¨æ„**: ä½¿ç”¨ Grafana Provisioning æ—¶ï¼Œå¯ä»¥åˆ›å»ºæ•°æ®æºé…ç½®æ–‡ä»¶ `/etc/grafana/provisioning/datasources/prometheus.yaml` è‡ªåŠ¨é…ç½®æ•°æ®æºã€‚

---

## ğŸ›ï¸ é¢æ¿åˆ—è¡¨

### ç¬¬ä¸€è¡Œï¼šæ¦‚è§ˆç»Ÿè®¡ (Row 1)

#### 1. ğŸ“Š æ€»è®¾å¤‡æ•°
- **ç±»å‹**: Stat (ç»Ÿè®¡å¡ç‰‡)
- **ä½ç½®**: ç¬¬ 1 è¡Œ, å·¦ä¾§ (8 åˆ—å®½)
- **æŸ¥è¯¢**: `max without(instance, job, pod, container, endpoint, namespace, service) (scrutiny_devices_total)`
- **è¯´æ˜**: æ˜¾ç¤ºå½“å‰ç›‘æ§çš„ç£ç›˜æ€»æ•°ï¼Œä½¿ç”¨èšåˆå‡½æ•°å»é™¤ Pod é‡å¯å¯¼è‡´çš„é‡å¤æ•°æ®
- **æ ¼å¼**: æ•°å­—

#### 2. ğŸ¥§ æŒ‰åè®®ç»Ÿè®¡
- **ç±»å‹**: Pie Chart (é¥¼å›¾)
- **ä½ç½®**: ç¬¬ 1 è¡Œ, ä¸­é—´ (8 åˆ—å®½)
- **æŸ¥è¯¢**: `max without(instance, job, pod, container, endpoint, namespace, service) (scrutiny_devices_by_protocol)`
- **è¯´æ˜**: æŒ‰åè®®ç±»å‹ï¼ˆATAã€NVMeï¼‰ç»Ÿè®¡è®¾å¤‡åˆ†å¸ƒï¼Œä½¿ç”¨èšåˆå‡½æ•°å»é™¤é‡å¤æ•°æ®
- **æ ¼å¼**: é¥¼å›¾ï¼Œæ˜¾ç¤ºåè®®åç§°å’Œæ•°é‡

#### 3. âš ï¸ æ•…éšœè®¾å¤‡æ•°
- **ç±»å‹**: Stat (ç»Ÿè®¡å¡ç‰‡)
- **ä½ç½®**: ç¬¬ 1 è¡Œ, å³ä¾§ (8 åˆ—å®½)
- **æŸ¥è¯¢**: `sum(min without(instance, job, pod, container, endpoint, namespace, service) (scrutiny_device_status{host_id=~"$host"}))`
- **è¯´æ˜**: ç»Ÿè®¡å¤„äºæ•…éšœçŠ¶æ€çš„è®¾å¤‡æ•°é‡
- **é¢œè‰²æ˜ å°„**:
  - ç»¿è‰²: 0 (æ— æ•…éšœ)
  - çº¢è‰²: > 0 (æœ‰æ•…éšœ)

---

### ç¬¬äºŒè¡Œï¼šæ¸©åº¦ç›‘æ§ (Row 2)

#### 4. ğŸŒ¡ï¸ è®¾å¤‡æ¸©åº¦å†å²
- **ç±»å‹**: Time Series (æ—¶é—´åºåˆ—å›¾)
- **ä½ç½®**: ç¬¬ 2 è¡Œ, å·¦ä¾§ (12 åˆ—å®½)
- **æŸ¥è¯¢**: `scrutiny_smart_temperature_celsius{host_id=~"$host"}`
- **è¯´æ˜**: æ˜¾ç¤ºæ‰€æœ‰è®¾å¤‡æ¸©åº¦çš„å†å²å˜åŒ–è¶‹åŠ¿
- **å›¾ä¾‹**: `{{host_id}}/{{device_name}}`ï¼ˆæ ¼å¼ï¼šä¸»æœºID/è®¾å¤‡åï¼‰
- **å•ä½**: Â°C (æ‘„æ°åº¦)
- **é˜ˆå€¼**:
  - ç»¿è‰²: < 55Â°C (æ­£å¸¸)
  - é»„è‰²: 55-65Â°C (è­¦å‘Š)
  - çº¢è‰²: > 65Â°C (ä¸¥é‡)

#### 5. ğŸ“ å½“å‰æ¸©åº¦
- **ç±»å‹**: Bar Gauge (æ¨ªå‘æ¡å½¢å›¾)
- **ä½ç½®**: ç¬¬ 2 è¡Œ, å³ä¾§ (12 åˆ—å®½)
- **æŸ¥è¯¢**: `scrutiny_smart_temperature_celsius{host_id=~"$host"}`
- **è¯´æ˜**: æ¨ªå‘æ¡å½¢å›¾æ˜¾ç¤ºå½“å‰å„è®¾å¤‡æ¸©åº¦
- **å›¾ä¾‹**: `{{host_id}}/{{device_name}}`ï¼ˆæ ¼å¼ï¼šä¸»æœºID/è®¾å¤‡åï¼‰
- **å•ä½**: Â°C
- **é˜ˆå€¼é…è‰²**: ä¸æ¸©åº¦å†å²ç›¸åŒ

---

### ç¬¬ä¸‰è¡Œï¼šä½¿ç”¨ç»Ÿè®¡ (Row 3)

#### 6. â±ï¸ é€šç”µæ—¶é—´ (Power On Hours)
- **ç±»å‹**: Time Series (æ—¶é—´åºåˆ—å›¾)
- **ä½ç½®**: ç¬¬ 3 è¡Œ, å·¦ä¾§ (12 åˆ—å®½)
- **æŸ¥è¯¢**: `scrutiny_smart_power_on_hours{host_id=~"$host"}`
- **è¯´æ˜**: æ˜¾ç¤ºå„è®¾å¤‡çš„ç´¯è®¡é€šç”µæ—¶é—´
- **å›¾ä¾‹**: `{{host_id}}/{{device_name}}`
- **å•ä½**: h (å°æ—¶)

#### 7. ğŸ”„ ç”µæºå¾ªç¯è®¡æ•°
- **ç±»å‹**: Time Series (æ—¶é—´åºåˆ—å›¾)
- **ä½ç½®**: ç¬¬ 3 è¡Œ, å³ä¾§ (12 åˆ—å®½)
- **æŸ¥è¯¢**: `scrutiny_smart_power_cycle_count{host_id=~"$host"}`
- **è¯´æ˜**: æ˜¾ç¤ºå„è®¾å¤‡çš„ç”µæºå¾ªç¯æ¬¡æ•°
- **å›¾ä¾‹**: `{{host_id}}/{{device_name}}`
- **å•ä½**: æ¬¡æ•°

---

### ç¬¬å››è¡Œï¼šSSD å¥åº·æŒ‡æ ‡ (Row 4)

#### 8. ğŸ’¿ NVMe SSD ç£¨æŸåº¦
- **ç±»å‹**: Gauge (ä»ªè¡¨ç›˜)
- **ä½ç½®**: ç¬¬ 4 è¡Œ, å·¦ä¾§ (6 åˆ—å®½)
- **æŸ¥è¯¢**: `scrutiny_smart_attr_percentage_used_value{protocol="NVMe", host_id=~"$host"}`
- **è¯´æ˜**: æ˜¾ç¤º NVMe SSD çš„å†™å…¥ç£¨æŸç™¾åˆ†æ¯”
- **å›¾ä¾‹**: `{{host_id}}/{{device_name}}`
- **å•ä½**: % (ç™¾åˆ†æ¯”)
- **é˜ˆå€¼**:
  - ç»¿è‰²: 0-80% (æ­£å¸¸)
  - é»„è‰²: 80-90% (è­¦å‘Š)
  - çº¢è‰²: 90-100% (ä¸¥é‡)
- **èŒƒå›´**: 0-100%

#### 9. ğŸ’¾ NVMe å¯ç”¨å¤‡ç”¨ç©ºé—´
- **ç±»å‹**: Gauge (ä»ªè¡¨ç›˜)
- **ä½ç½®**: ç¬¬ 4 è¡Œ, å³ä¾§ (6 åˆ—å®½)
- **æŸ¥è¯¢**: `scrutiny_smart_attr_available_spare_value{protocol="NVMe", host_id=~"$host"}`
- **è¯´æ˜**: æ˜¾ç¤º NVMe SSD çš„å¯ç”¨å¤‡ç”¨å—ç™¾åˆ†æ¯”
- **å›¾ä¾‹**: `{{host_id}}/{{device_name}}`
- **å•ä½**: %
- **é˜ˆå€¼**:
  - çº¢è‰²: 0-20% (ä¸¥é‡)
  - é»„è‰²: 20-50% (è­¦å‘Š)
  - ç»¿è‰²: 50-100% (æ­£å¸¸)
- **èŒƒå›´**: 0-100%

---

### ç¬¬äº”è¡Œï¼šè®¾å¤‡ä¿¡æ¯è¡¨æ ¼ (Row 5)

#### 10. ğŸ“‹ è®¾å¤‡åˆ—è¡¨
- **ç±»å‹**: Table (è¡¨æ ¼)
- **ä½ç½®**: ç¬¬ 5 è¡Œ, å…¨å®½ (24 åˆ—)
- **æŸ¥è¯¢**ï¼ˆä½¿ç”¨èšåˆå‡½æ•°å»é™¤é‡å¤æ•°æ®ï¼‰:
  - A: `group without(...) (scrutiny_device_info{host_id=~"$host"})` (è®¾å¤‡ä¿¡æ¯)
  - B: `max without(...) (scrutiny_smart_temperature_celsius{host_id=~"$host"})` (æ¸©åº¦)
  - C: `max without(...) (scrutiny_smart_power_on_hours{host_id=~"$host"})` (é€šç”µæ—¶é—´)
  - D: `max without(...) (scrutiny_device_capacity_bytes{host_id=~"$host"})` (å®¹é‡)
  - E: `min without(...) (scrutiny_device_status{host_id=~"$host"})` (çŠ¶æ€)
  - F: `max without(...) (scrutiny_smart_collector_timestamp{host_id=~"$host"})` (æ”¶é›†æ—¶é—´)
- **è¯´æ˜**: ç»¼åˆå±•ç¤ºæ‰€æœ‰è®¾å¤‡çš„å…³é”®ä¿¡æ¯ï¼Œæ¯ä¸ªè®¾å¤‡ï¼ˆæŒ‰ WWN å’Œä¸»æœºID å”¯ä¸€æ ‡è¯†ï¼‰æ˜¾ç¤ºä¸ºä¸€è¡Œ
- **æ•°æ®è½¬æ¢**:
  - **Merge**: åˆå¹¶æ‰€æœ‰æŸ¥è¯¢ç»“æœ
  - **Organize**: æ•´ç†åˆ—é¡ºåºï¼Œæ’é™¤ Kubernetes ç›¸å…³æ ‡ç­¾
  - **GroupBy**: æŒ‰ `WWN` + `ä¸»æœº` åˆ†ç»„ï¼Œç¡®ä¿ç›¸åŒè®¾å¤‡åä½†ä¸åŒä¸»æœºçš„è®¾å¤‡æ­£ç¡®æ˜¾ç¤ºä¸ºç‹¬ç«‹è¡Œ
- **åˆ—**ï¼ˆæŒ‰æ˜¾ç¤ºé¡ºåºï¼‰:
  - ä¸»æœº (`host_id`) - ä¸»æœºæ ‡è¯†
  - è®¾å¤‡å (`device_name`) - è®¾å¤‡åç§°ï¼ˆå¦‚ sdaï¼‰
  - å‹å· (`model_name`) - è®¾å¤‡å‹å·
  - åè®® (`protocol`) - åè®®ç±»å‹ï¼ˆATA/NVMeï¼‰
  - åºåˆ—å· (`serial_number`) - åºåˆ—å·
  - å›ºä»¶ (`firmware`) - å›ºä»¶ç‰ˆæœ¬
  - æ¸©åº¦ (Â°C, 1ä½å°æ•°, å¸¦é¢œè‰²æ¸å˜ï¼š<55Â°Cç»¿è‰², 55-65Â°Cé»„è‰², >65Â°Cçº¢è‰²)
  - é€šç”µæ—¶é—´ (å°æ—¶, æ•´æ•°æ˜¾ç¤º)
  - å®¹é‡ (å­—èŠ‚ï¼Œè‡ªåŠ¨æ ¼å¼åŒ–ä¸º GB/TB, 2ä½å°æ•°)
  - çŠ¶æ€ (0=æ­£å¸¸[ç»¿è‰²èƒŒæ™¯], 1=æ•…éšœ[çº¢è‰²èƒŒæ™¯])
  - æ”¶é›†æ—¶é—´ (UTC æ—¶é—´æˆ³ï¼Œè‡ªåŠ¨æ ¼å¼åŒ–ä¸ºæ—¥æœŸæ—¶é—´)
  - WWN (`wwn`) - å…¨å±€å”¯ä¸€æ ‡è¯†ç¬¦ï¼ˆæœ€åä¸€åˆ—ï¼‰

---

### ç¬¬å…­è¡Œï¼šé”™è¯¯ç›‘æ§ (Row 6)

#### 11. ğŸ”´ ATA å…³é”®é”™è¯¯æŒ‡æ ‡
- **ç±»å‹**: Time Series (æ—¶é—´åºåˆ—å›¾)
- **ä½ç½®**: ç¬¬ 6 è¡Œ, å·¦ä¾§ (12 åˆ—å®½)
- **æŸ¥è¯¢**:
  - A: `scrutiny_smart_attr_5_raw_value{attribute_id="5", protocol="ATA", host_id=~"$host"}`
    - å›¾ä¾‹: `{{host_id}}/{{device_name}} - é‡æ–°åˆ†é…æ‰‡åŒº`
  - B: `scrutiny_smart_attr_197_raw_value{attribute_id="197", protocol="ATA", host_id=~"$host"}`
    - å›¾ä¾‹: `{{host_id}}/{{device_name}} - å¾…å¤„ç†æ‰‡åŒº`
  - C: `scrutiny_smart_attr_198_raw_value{attribute_id="198", protocol="ATA", host_id=~"$host"}`
    - å›¾ä¾‹: `{{host_id}}/{{device_name}} - ç¦»çº¿ä¸å¯çº æ­£`
- **è¯´æ˜**: ç›‘æ§ ATA ç£ç›˜çš„å…³é”®é”™è¯¯è®¡æ•°å™¨ï¼ˆä½¿ç”¨åŸå§‹å€¼ï¼‰
- **å•ä½**: æ‰‡åŒºæ•°
- **é˜ˆå€¼**: > 0 ä¸ºè­¦å‘Šï¼ˆçº¢è‰²ï¼‰

#### 12. âš¡ NVMe é”™è¯¯æŒ‡æ ‡
- **ç±»å‹**: Time Series (æ—¶é—´åºåˆ—å›¾)
- **ä½ç½®**: ç¬¬ 6 è¡Œ, å³ä¾§ (12 åˆ—å®½)
- **æŸ¥è¯¢**:
  - A: `scrutiny_smart_attr_media_errors_value{protocol="NVMe", host_id=~"$host"}`
    - å›¾ä¾‹: `{{host_id}}/{{device_name}} - ä»‹è´¨é”™è¯¯`
  - B: `scrutiny_smart_attr_num_err_log_entries_value{protocol="NVMe", host_id=~"$host"}`
    - å›¾ä¾‹: `{{host_id}}/{{device_name}} - é”™è¯¯æ—¥å¿—æ¡ç›®`
  - C: `scrutiny_smart_attr_unsafe_shutdowns_value{protocol="NVMe", host_id=~"$host"}`
    - å›¾ä¾‹: `{{host_id}}/{{device_name}} - ä¸å®‰å…¨å…³æœº`
- **è¯´æ˜**: ç›‘æ§ NVMe è®¾å¤‡çš„å…³é”®é”™è¯¯æŒ‡æ ‡
- **å•ä½**: æ¬¡æ•°
- **é˜ˆå€¼**: > 0 ä¸ºè­¦å‘Šï¼ˆçº¢è‰²ï¼‰

---

### ç¬¬ä¸ƒè¡Œï¼šSMART çŠ¶æ€è¯¦æƒ… (Row 7)

#### 13. ğŸ“ SMART çŠ¶æ€ (å­—ç¬¦ä¸²å­—æ®µ)
- **ç±»å‹**: Table (è¡¨æ ¼)
- **ä½ç½®**: ç¬¬ 7 è¡Œ, å…¨å®½ (24 åˆ—)
- **æŸ¥è¯¢**:
  - A: `scrutiny_smart_attr_5_status_info{host_id=~"$host"}` (ATA å±æ€§ 5 çŠ¶æ€)
  - B: `scrutiny_smart_attr_197_status_info{host_id=~"$host"}` (ATA å±æ€§ 197 çŠ¶æ€)
  - C: `scrutiny_smart_attr_198_status_info{host_id=~"$host"}` (ATA å±æ€§ 198 çŠ¶æ€)
  - D: `scrutiny_smart_attr_critical_warning_status_info{protocol="NVMe", host_id=~"$host"}` (NVMe å…³é”®è­¦å‘ŠçŠ¶æ€)
- **è¯´æ˜**: æ˜¾ç¤ºå…³é”® SMART å±æ€§çš„å­—ç¬¦ä¸²çŠ¶æ€ä¿¡æ¯ï¼ˆå¦‚ "PASSED"ã€"OK" ç­‰æ–‡æœ¬çŠ¶æ€ï¼‰
- **åˆ—**:
  - ä¸»æœº (`host_id`)
  - è®¾å¤‡ (`device_name`)
  - å‹å· (`model_name`)
  - åè®® (`protocol`)
  - å±æ€§ (`attribute_id`) - SMART å±æ€§ ID
  - çŠ¶æ€ (`value`) - å­—ç¬¦ä¸²çŠ¶æ€å€¼ï¼ˆå¦‚ "PASSED"ã€"OK"ï¼‰
  - WWN
- **æ³¨æ„äº‹é¡¹**:
  - æ­¤é¢æ¿æ˜¾ç¤ºçš„æ˜¯å­—ç¬¦ä¸²ç±»å‹çš„ SMART çŠ¶æ€å­—æ®µï¼ˆ`status`ã€`raw_string`ã€`status_reason` ç­‰ï¼‰
  - å¦‚æœè®¾å¤‡æ²¡æœ‰è¿™äº›å±æ€§ï¼Œæˆ–è€…è¿™äº›å±æ€§çš„çŠ¶æ€å­—æ®µæ˜¯æ•°å€¼ç±»å‹è€Œéå­—ç¬¦ä¸²ï¼Œåˆ™ä¸ä¼šæ˜¾ç¤ºæ•°æ®
  - ATA è®¾å¤‡é€šå¸¸æœ‰ `status` å­—æ®µï¼ˆå¦‚å±æ€§ 5ã€197ã€198ï¼‰
  - NVMe è®¾å¤‡é€šå¸¸æœ‰ `critical_warning` çš„å­—ç¬¦ä¸²çŠ¶æ€
  - å¦‚æœé¢æ¿ä¸ºç©ºï¼Œè¯´æ˜å½“å‰è®¾å¤‡æ²¡æœ‰è¿™äº›å­—ç¬¦ä¸²ç±»å‹çš„ SMART çŠ¶æ€å­—æ®µ

---

## ğŸ¯ Dashboard å˜é‡

### æ•°æ®æºå˜é‡
- **åç§°**: `DS_PROMETHEUS`
- **ç±»å‹**: Datasource
- **æŸ¥è¯¢**: `prometheus`
- **è¯´æ˜**: Prometheus æ•°æ®æºé€‰æ‹©å™¨

### ä¸»æœºè¿‡æ»¤å˜é‡
- **åç§°**: `host`
- **ç±»å‹**: Query
- **æŸ¥è¯¢**: `label_values(scrutiny_device_info, host_id)`
- **è¯´æ˜**: ä¸»æœº ID å¤šé€‰ä¸‹æ‹‰èœå•ï¼Œç”¨äºæŒ‰ä¸»æœºè¿‡æ»¤è®¾å¤‡
- **ç‰¹æ€§**:
  - æ”¯æŒå¤šé€‰
  - æ”¯æŒ "All" é€‰é¡¹ï¼ˆæ˜¾ç¤ºæ‰€æœ‰ä¸»æœºçš„è®¾å¤‡ï¼‰
  - æ”¯æŒæ­£åˆ™è¡¨è¾¾å¼è¿‡æ»¤
  - **å”¯ä¸€è¿‡æ»¤å˜é‡**: Dashboard ä»…é€šè¿‡ä¸»æœºè¿›è¡Œè¿‡æ»¤ï¼Œæ˜¾ç¤ºæ‰€é€‰ä¸»æœºçš„æ‰€æœ‰è®¾å¤‡

---

## ğŸ¨ é¢æ¿å¸ƒå±€

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Row 1: æ¦‚è§ˆç»Ÿè®¡                                              â”‚
â”‚ [æ€»è®¾å¤‡æ•°]  [æŒ‰åè®®ç»Ÿè®¡(é¥¼å›¾)]  [æ•…éšœè®¾å¤‡æ•°]               â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Row 2: æ¸©åº¦ç›‘æ§                                              â”‚
â”‚ [è®¾å¤‡æ¸©åº¦å†å² - æ—¶é—´åºåˆ—]  [å½“å‰æ¸©åº¦ - æ¡å½¢å›¾]             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Row 3: ä½¿ç”¨ç»Ÿè®¡                                              â”‚
â”‚ [é€šç”µæ—¶é—´å†å²]              [ç”µæºå¾ªç¯è®¡æ•°]                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Row 4: SSD å¥åº·                                              â”‚
â”‚ [NVMe ç£¨æŸåº¦ä»ªè¡¨ç›˜]        [NVMe å¯ç”¨å¤‡ç”¨ç©ºé—´ä»ªè¡¨ç›˜]        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Row 5: è®¾å¤‡ä¿¡æ¯                                              â”‚
â”‚ [è®¾å¤‡åˆ—è¡¨ - ç»¼åˆä¿¡æ¯è¡¨æ ¼ (å…¨å®½)]                            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Row 6: é”™è¯¯ç›‘æ§                                              â”‚
â”‚ [ATA å…³é”®é”™è¯¯æŒ‡æ ‡]         [NVMe é”™è¯¯æŒ‡æ ‡]                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Row 7: è¯¦ç»†çŠ¶æ€                                              â”‚
â”‚ [SMART çŠ¶æ€è¡¨æ ¼ (å­—ç¬¦ä¸²å­—æ®µ) - å…¨å®½]                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ“ˆ ä½¿ç”¨çš„ Metrics

### è®¾å¤‡ä¿¡æ¯ç±»
- `scrutiny_device_info`
- `scrutiny_device_capacity_bytes`
- `scrutiny_device_status`
- `scrutiny_devices_total`
- `scrutiny_devices_by_protocol`

### æ¸©åº¦å’Œä½¿ç”¨ç»Ÿè®¡
- `scrutiny_smart_temperature_celsius`
- `scrutiny_smart_power_on_hours`
- `scrutiny_smart_power_cycle_count`

### NVMe ç‰¹å®šæŒ‡æ ‡
- `scrutiny_smart_attr_percentage_used_value` (ç£¨æŸåº¦)
- `scrutiny_smart_attr_available_spare_value` (å¯ç”¨å¤‡ç”¨ç©ºé—´)
- `scrutiny_smart_attr_media_errors_value` (ä»‹è´¨é”™è¯¯)
- `scrutiny_smart_attr_num_err_log_entries_value` (é”™è¯¯æ—¥å¿—)
- `scrutiny_smart_attr_unsafe_shutdowns_value` (ä¸å®‰å…¨å…³æœº)
- `scrutiny_smart_attr_critical_warning_status_info` (å…³é”®è­¦å‘ŠçŠ¶æ€)

### ATA é”™è¯¯æŒ‡æ ‡
- `scrutiny_smart_attr_5_raw_value` (é‡æ–°åˆ†é…æ‰‡åŒº)
- `scrutiny_smart_attr_197_raw_value` (å¾…å¤„ç†æ‰‡åŒº)
- `scrutiny_smart_attr_198_raw_value` (ç¦»çº¿ä¸å¯çº æ­£æ‰‡åŒº)
- `scrutiny_smart_attr_5_status_info` (å±æ€§ 5 çŠ¶æ€)
- `scrutiny_smart_attr_197_status_info` (å±æ€§ 197 çŠ¶æ€)
- `scrutiny_smart_attr_198_status_info` (å±æ€§ 198 çŠ¶æ€)

---

## ğŸ¨ é¢œè‰²å’Œé˜ˆå€¼

### æ¸©åº¦
- ğŸŸ¢ ç»¿è‰²: < 55Â°C (æ­£å¸¸)
- ğŸŸ¡ é»„è‰²: 55-65Â°C (è­¦å‘Š)
- ğŸ”´ çº¢è‰²: > 65Â°C (ä¸¥é‡)

### SSD ç£¨æŸåº¦
- ğŸŸ¢ ç»¿è‰²: 0-80% (æ­£å¸¸)
- ğŸŸ¡ é»„è‰²: 80-90% (æ³¨æ„)
- ğŸ”´ çº¢è‰²: 90-100% (ç´§æ€¥)

### å¯ç”¨å¤‡ç”¨ç©ºé—´
- ğŸ”´ çº¢è‰²: 0-20% (ç´§æ€¥)
- ğŸŸ¡ é»„è‰²: 20-50% (è­¦å‘Š)
- ğŸŸ¢ ç»¿è‰²: 50-100% (æ­£å¸¸)

### è®¾å¤‡çŠ¶æ€
- ğŸŸ¢ ç»¿è‰²: 0 (æ­£å¸¸)
- ğŸ”´ çº¢è‰²: 1 (æ•…éšœ)

### é”™è¯¯è®¡æ•°
- ğŸŸ¢ ç»¿è‰²: 0 (æ­£å¸¸)
- ğŸ”´ çº¢è‰²: > 0 (æœ‰é”™è¯¯)

---

## ğŸ” äº¤äº’åŠŸèƒ½

### æ—¶é—´èŒƒå›´é€‰æ‹©
- é»˜è®¤: æœ€è¿‘ 6 å°æ—¶
- æ”¯æŒè‡ªå®šä¹‰æ—¶é—´èŒƒå›´
- æ”¯æŒæ—¶é—´èŒƒå›´ç¼©æ”¾ (æ‹–åŠ¨é€‰æ‹©)

### ä¸»æœºè¿‡æ»¤
- å˜é‡ `$host` æ”¯æŒ:
  - å•é€‰/å¤šé€‰ä¸»æœº
  - é€‰æ‹© "All" æŸ¥çœ‹æ‰€æœ‰ä¸»æœºçš„è®¾å¤‡
  - æ­£åˆ™è¡¨è¾¾å¼è¿‡æ»¤
  - é€‰æ‹©ä¸»æœºåï¼Œæ˜¾ç¤ºè¯¥ä¸»æœºçš„æ‰€æœ‰è®¾å¤‡

### å›¾ä¾‹äº¤äº’
- ç‚¹å‡»å›¾ä¾‹å¯éšè—/æ˜¾ç¤ºå¯¹åº”è®¾å¤‡
- Shift+ç‚¹å‡»å¯åªæ˜¾ç¤ºè¯¥è®¾å¤‡

### æ‚¬åœæç¤º
- æ—¶é—´åºåˆ—å›¾: æ˜¾ç¤ºå…·ä½“æ—¶é—´ç‚¹çš„å€¼
- è¡¨æ ¼: æ˜¾ç¤ºå®Œæ•´å•å…ƒæ ¼å†…å®¹
- ä»ªè¡¨ç›˜: æ˜¾ç¤ºå½“å‰å€¼å’Œé˜ˆå€¼

### è‡ªåŠ¨åˆ·æ–°
- é»˜è®¤: 30 ç§’è‡ªåŠ¨åˆ·æ–°
- å¯æ‰‹åŠ¨è°ƒæ•´åˆ·æ–°é—´éš”
- æ”¯æŒæ‰‹åŠ¨åˆ·æ–°

---

## ğŸš€ ä½¿ç”¨å»ºè®®

### æ—¥å¸¸ç›‘æ§
1. æŸ¥çœ‹"æ€»è®¾å¤‡æ•°"å’Œ"æ•…éšœè®¾å¤‡æ•°"å¿«é€Ÿäº†è§£æ•´ä½“çŠ¶æ€
2. å…³æ³¨"è®¾å¤‡æ¸©åº¦å†å²"å‘ç°æ¸©åº¦å¼‚å¸¸
3. æŸ¥çœ‹"è®¾å¤‡åˆ—è¡¨"è·å–æ‰€æœ‰è®¾å¤‡æ¦‚è§ˆ

### å¤šä¸»æœºç¯å¢ƒç›‘æ§
1. **é€‰æ‹©ä¸»æœº**: åœ¨é¡¶éƒ¨å˜é‡æ é€‰æ‹© `ä¸»æœº` (å¯å¤šé€‰æˆ– All)
2. **æŸ¥çœ‹æ‰€æœ‰è®¾å¤‡**: é€‰æ‹©ä¸»æœºåï¼Œæ‰€æœ‰é¢æ¿è‡ªåŠ¨æ˜¾ç¤ºè¯¥ä¸»æœºçš„æ‰€æœ‰è®¾å¤‡
3. **åˆ‡æ¢ä¸»æœº**: é€‰æ‹©ä¸åŒä¸»æœºæ—¶ï¼Œæ‰€æœ‰é¢æ¿è‡ªåŠ¨æ›´æ–°æ•°æ®
4. **å¯¹æ¯”ç›‘æ§**: é€‰æ‹©å¤šä¸ªä¸»æœºï¼Œå¯¹æ¯”ä¸åŒä¸»æœºçš„è®¾å¤‡çŠ¶æ€

### æ•…éšœæ’æŸ¥æµç¨‹
1. ä½¿ç”¨ä¸»æœºè¿‡æ»¤å˜é‡ç­›é€‰ç‰¹å®šä¸»æœºçš„è®¾å¤‡
2. æŸ¥çœ‹"ATA å…³é”®é”™è¯¯æŒ‡æ ‡"æˆ–"NVMe é”™è¯¯æŒ‡æ ‡"
3. æ£€æŸ¥"SMART çŠ¶æ€"è¡¨æ ¼äº†è§£è¯¦ç»†çŠ¶æ€
4. åœ¨"è®¾å¤‡åˆ—è¡¨"è¡¨æ ¼ä¸­æŸ¥çœ‹æ‰€æœ‰è®¾å¤‡çš„è¯¦ç»†ä¿¡æ¯

### SSD å¥åº·æ£€æŸ¥
1. å…³æ³¨"NVMe SSD ç£¨æŸåº¦"ä»ªè¡¨ç›˜
2. ç›‘æ§"NVMe å¯ç”¨å¤‡ç”¨ç©ºé—´"
3. æŸ¥çœ‹"NVMe é”™è¯¯æŒ‡æ ‡"ä¸­çš„ä»‹è´¨é”™è¯¯

### å®¹é‡è§„åˆ’
1. æŸ¥çœ‹"é€šç”µæ—¶é—´"è¯„ä¼°è®¾å¤‡å¯¿å‘½
2. å…³æ³¨"ç”µæºå¾ªç¯è®¡æ•°"äº†è§£ä½¿ç”¨é¢‘ç‡
3. ç»“åˆ"è®¾å¤‡åˆ—è¡¨"ä¸­çš„å®¹é‡ä¿¡æ¯

---

## ğŸ› æ•…éšœæ’æŸ¥

### Dashboard æ˜¾ç¤º "No data"

1. **æ£€æŸ¥ Prometheus æ•°æ®æº**:
   ```bash
   # æµ‹è¯• Prometheus è¿æ¥
   curl http://localhost:9090/api/v1/query?query=scrutiny_devices_total
   ```

2. **æ£€æŸ¥ Exporter æ˜¯å¦è¿è¡Œ**:
   ```bash
   curl http://localhost:9900/metrics | grep scrutiny_device_info
   ```

3. **æ£€æŸ¥ Prometheus Targets**:
   - è®¿é—® `http://localhost:9090/targets`
   - ç¡®è®¤ exporter target çŠ¶æ€ä¸º "UP"

4. **æ£€æŸ¥æ—¶é—´èŒƒå›´**: ç¡®ä¿é€‰æ‹©çš„æ—¶é—´èŒƒå›´å†…æœ‰æ•°æ®

### éƒ¨åˆ†é¢æ¿æ— æ•°æ®

- NVMe é¢æ¿åªå¯¹ NVMe è®¾å¤‡æœ‰æ•ˆ
- ATA é”™è¯¯æŒ‡æ ‡åªå¯¹ ATA/SATA è®¾å¤‡æœ‰æ•ˆ

### æŒ‡æ ‡åç§°ä¸åŒ¹é…

å¦‚æœä½ ä½¿ç”¨çš„æ˜¯æ—§ç‰ˆæœ¬çš„ Exporterï¼ŒæŒ‡æ ‡åç§°å¯èƒ½ä¸åŒã€‚è¯·ï¼š
1. æ£€æŸ¥ Exporter ç‰ˆæœ¬
2. æ›´æ–°åˆ°æœ€æ–°ç‰ˆæœ¬
3. æˆ–æ ¹æ®å®é™…æŒ‡æ ‡åç§°ä¿®æ”¹ Dashboard æŸ¥è¯¢

## ğŸ¨ è‡ªå®šä¹‰ Dashboard

### æ·»åŠ æ–°é¢æ¿

1. ç‚¹å‡» **"Add panel"**
2. é€‰æ‹©å¯è§†åŒ–ç±»å‹
3. ç¼–å†™ PromQL æŸ¥è¯¢ï¼ˆå‚è€ƒä¸Šé¢çš„é¢æ¿åˆ—è¡¨ï¼‰
4. é…ç½®æ ·å¼å’Œé˜ˆå€¼
5. ä¿å­˜

### ä¿®æ”¹ç°æœ‰é¢æ¿

1. ç‚¹å‡»é¢æ¿æ ‡é¢˜ -> **"Edit"**
2. ä¿®æ”¹æŸ¥è¯¢ã€æ ·å¼ç­‰
3. ç‚¹å‡» **"Apply"** ä¿å­˜

## ğŸ“ æ³¨æ„äº‹é¡¹

1. **æ€§èƒ½ä¼˜åŒ–**: ç›‘æ§å¤§é‡è®¾å¤‡ï¼ˆ>50 å°ï¼‰æ—¶ï¼Œå»ºè®®ï¼š
   - å¢åŠ  Prometheus scrape_intervalï¼ˆå¦‚ 60sï¼‰
   - è°ƒæ•´ Dashboard åˆ·æ–°é—´éš”ä¸º 1 åˆ†é’Ÿæˆ–æ›´é•¿
   - ä½¿ç”¨ä¸»æœºè¿‡æ»¤å˜é‡

2. **æ•°æ®ä¿ç•™**: Prometheus é»˜è®¤ä¿ç•™ 15 å¤©æ•°æ®ï¼Œå¯é€šè¿‡ `--storage.tsdb.retention.time` è°ƒæ•´

3. **å•ä½è½¬æ¢**: Dashboard å·²é…ç½®å¸¸ç”¨å•ä½ï¼ˆæ¸©åº¦ã€å®¹é‡ã€æ—¶é—´ï¼‰

## ğŸ“‹ å·²çŸ¥é™åˆ¶

1. **NVMe ç‰¹å®šé¢æ¿**: åªå¯¹ NVMe è®¾å¤‡æœ‰æ•ˆ
2. **ATA é”™è¯¯é¢æ¿**: åªå¯¹ ATA/SATA è®¾å¤‡æœ‰æ•ˆ
3. **å­—ç¬¦ä¸²çŠ¶æ€**: åªæ˜¾ç¤ºå…³é”®çš„å‡ ä¸ª SMART å±æ€§çŠ¶æ€

---

**æœ€åæ›´æ–°**: 2025-11-14  
**Dashboard ç‰ˆæœ¬**: 1.0  
**Grafana å…¼å®¹ç‰ˆæœ¬**: 10.0.0+

